---
title: 从零开始学深度学习——拉格朗日乘数法
top: false
cover: false
toc: true
mathjax: true
date: 2021-01-17 22:36:16
password:
summary:
tags: [数学, 深度学习]
categories: [深度学习]
---



# 多元函数的极值

## 多元函数极值的定义

在看多元函数极值定义之前回顾下一元函数的极值定义

> 设函数 $y=f(x)$ 在 $x_0$ 的某领域 $U(x_0)$ 内有定义，如果对于去心领域 $U^o(x_0)$ 内的任一 $x$ 有 $f(x) \lt f(x_0)$ 或 $f(x) \gt f(x_0)$，则称 $f(x_0)$ 是 $f(x)$ 的一个极大值或者极小值，$x_0$ 称为极大值点或者极小值点。



多元函数极值定义跟一元函数的极值定义类似：

> 设函数 $\zeta = f(x, y)$ 的定义域为 $D$，$M_0(x_0, y_0)$ 为 $D$内的某一点，如果对于 $M_0$ 的某个领域 $U(M_0)$ 内任一不同于 $M_0$ 的点 $(x, y)$，都有 $f(x, y) < f(x_0, y_0)$ 或者 $f(x, y) > f(x_0, y_0)$ 时，称 $f(x_0, y_0)$ 为极大值或者极小值，$(x_0, y_0)$ 为极大值点或者极小值点。



## 多元函数极值的求法

多元函数的极值问题分无条件极值和条件极值2种情况。



### 无条件极值

#### 无条件极值的定义

$\zeta=f(x, y), (x, y)\in D$，并且 $D$ 是一个开区域，$\zeta=f(x, y)$ 在 $D$ 内的极值称为无条件极值。



#### 无条件极值的求法

1. 令 $f(x)=\left\{ \begin{aligned} \frac{\partial \zeta}{\partial x} = \ ... \ = 0 \\ \frac{\partial \zeta}{\partial y} = \ ... \ = 0 \end{aligned} \right.$  $\Longrightarrow$  $\left\{ \begin{aligned} x=? \\ y=? \end{aligned} \right.$
2. 判别法：

设 $f(x_0, y_0)$ 为驻点，$f^{(2)}_{xx}(x_0, y_0)=A, \ f^{(2)}_{xy}(x_0, y_0)=B, \ f^{(2)}_{yy}(x_0, y_0)=C$ 

* 若 $AC-B^2 > 0，(x_0, y_0)$为极值点。
    * $A < 0，(x_0, y_0)$ 为极大值点。
    * $A > 0， (x_0, y_0)$ 为极小值点。

* 若 $AC - B^2 < 0，(x_0, y_0)$ 不为极值点。



例. 求 $\zeta=x^3-y^3+3x^2+3y^2-9x$ 的极值。
$$
\frac{\partial \zeta}{\partial x} = 3x^2+6x-9=0 \Rightarrow x = 1 \ 或 \ x= -3 \\
\frac{\partial \zeta}{\partial y} = -3y^2+6y=0 \Rightarrow y = 0 \ 或 \ y =  2 \\
\therefore (1, 0), \ (-3, 0), \ (1, 2) \ (-3, 2) \ 都可能为极值点 \\
\frac{\partial^2 \zeta}{\partial x^2} = 6x + 6, \ \frac{\partial^2 \zeta}{\partial x\partial y}=0, \ \frac{\partial^2 \zeta}{\partial y^2} = -6y + 6 \\
对于(1, 0), \ A=12, \ B=0, \ C=6, AC-B^2>0 \\ 
\therefore (1,0)是极小值点, \ 极小值为\zeta(1,0)=-5 \\
对于(-3, 0),\ A=-12, \ B=0, \ C=6, AC-B^2<0 \\ 
\therefore (-3, 0)不是极值点 \\
对于(1, 2), \ A=12, \ B=0, \ C=-1, \ AC-B^2<0, \\
\therefore (1, 2)不是极值点 \\
对于(-3, 2), \ A=-12, \ B=0, \ C=-6, \ AC-B^2>0, \\
\therefore (-3,2)是极大值点, \ 极大值为\zeta(-3,2)=31
$$


### 条件极值

$\zeta=f(x,y)$ 同时 $x,y$ 又满足条件 $\phi(x,y)=0$，求 $\zeta$ 的极值

求解方法：**拉格朗日乘数法**

* $F=f(x,y)+\lambda \phi(x, y)$
* 由 $\left\{ \begin{aligned} F_x=f_x+\lambda \phi(x, y) = 0 \\ F_y=f_y+\lambda \phi(x,y) = 0 \\ F_{\lambda} = \phi(x, y) = 0 \ \ \ \ \ \ \ \ \ \ \ \end{aligned} \right.$   $\Longrightarrow$ $\left\{ \begin{aligned} x=? \\ y=? \end{aligned} \right.$

找到若干组 $x,y$ 代入$\zeta$，值最小的是极值点。



例1. $u=u(x, y),\ du=2xdx-2ydy,\ u(0,0)=2$ 求 $u(x, y)$ 和 $u(x,y)$ 在 $x^2+4y^2\leq 4$ 上的 $m,\ M$
$$
du = 2xdx - 2ydy = d(x^2-y^2) \Rightarrow u = x^2 - y^2 + C \\
\because u(0,0)=2, \ \therefore C = 2, \ u(x, y)=x^2-y^2 + 2 \\
当\ x^2 + 4y^2 \lt 4 \ 时，由\left\{ \begin{aligned} \frac{\partial u}{\partial x} = 2x = 0 \ \ \ \\ \frac{\partial u}{\partial y} = -2y = 0 \end{aligned} \right. \Rightarrow \left\{ \begin{aligned} x = 0\\ y = 0 \end{aligned} \right. , \ u(0, 0) = 2 \\
当\ x^2 + 4y^2 = 4 \ 时，F = x^2 - y^2 + 2 + \lambda (x^2 + 4y^2 - 4) \\
由 \left\{ \begin{aligned} F_x = 2x + 2\lambda x = 0 \ \ \ \ \ \ \\ F_y = -2y + 8\lambda y = 0 \ \ \  \\ F_{\lambda} = x^2 + 4y^2 -4 = 0 \end{aligned} \right. \Rightarrow \left\{ \begin{aligned} x(\lambda + 1) = 0 \\ y(4\lambda - 1) = 0 \\ x^2 + 4y^2 = 4 \end{aligned} \right. \\
\Rightarrow \left\{ \begin{aligned} x = 0 \ \ \ \\ y = \pm1 \\  \end{aligned} \right. , \ \left\{ \begin{aligned} x = \pm2 \\ y = 0 \ \ \ \\  \end{aligned} \right. , \ u(0, \pm1) = 1, \ u(\pm2, 0) = 6 \\
\therefore m = 1 \ M = 6
$$


 ## 关于拉格朗日乘数法的几何意义



